apiVersion: networking.istio.io/v1alpha3
kind: VirtualService
metadata:
  name: manager-agent-ai-vs
  namespace: manager-agent-ai
spec:
  hosts:
  - "*"
  gateways:
  - manager-agent-ai-gateway
  http:
  - match:
    - uri:
        prefix: /api/
    route:
    - destination:
        host: api-gateway-service
        port:
          number: 3000
    timeout: 30s
    retries:
      attempts: 3
      perTryTimeout: 10s
  - match:
    - uri:
        prefix: /dashboard/
    route:
    - destination:
        host: dashboard-service
        port:
          number: 3000
    timeout: 30s
  - match:
    - uri:
        prefix: /ws
    route:
    - destination:
        host: dashboard-service
        port:
          number: 3000
    timeout: 30s
  - match:
    - uri:
        prefix: /
    route:
    - destination:
        host: dashboard-service
        port:
          number: 3000
    timeout: 30s
---
apiVersion: networking.istio.io/v1alpha3
kind: VirtualService
metadata:
  name: api-gateway-vs
  namespace: manager-agent-ai
spec:
  hosts:
  - api-gateway-service
  gateways:
  - manager-agent-ai-internal-gateway
  http:
  - match:
    - uri:
        prefix: /api/projects
    route:
    - destination:
        host: project-manager-service
        port:
          number: 3000
    timeout: 30s
  - match:
    - uri:
        prefix: /api/tasks
    route:
    - destination:
        host: ai-planner-service
        port:
          number: 3000
    timeout: 30s
  - match:
    - uri:
        prefix: /api/workflows
    route:
    - destination:
        host: workflow-orchestrator-service
        port:
          number: 3000
    timeout: 30s
  - match:
    - uri:
        prefix: /api/notifications
    route:
    - destination:
        host: smart-notifications-service
        port:
          number: 3000
    timeout: 30s
  - match:
    - uri:
        prefix: /api/templates
    route:
    - destination:
        host: template-generator-service
        port:
          number: 3000
    timeout: 30s
  - match:
    - uri:
        prefix: /api/consistency
    route:
    - destination:
        host: consistency-manager-service
        port:
          number: 3000
    timeout: 30s
  - match:
    - uri:
        prefix: /api-versioning/
    route:
    - destination:
        host: api-versioning-service
        port:
          number: 3008
    timeout: 30s
  - match:
    - uri:
        prefix: /deadline-prediction/
    route:
    - destination:
        host: deadline-prediction-service
        port:
          number: 3009
    timeout: 30s
  - match:
    - uri:
        prefix: /task-distribution/
    route:
    - destination:
        host: task-distribution-service
        port:
          number: 3010
    timeout: 30s
  - match:
    - uri:
        prefix: /automatic-status-updates/
    route:
    - destination:
        host: automatic-status-updates-service
        port:
          number: 3011
    timeout: 30s
  - match:
    - uri:
        prefix: /sprint-planning/
    route:
    - destination:
        host: sprint-planning-service
        port:
          number: 3012
    timeout: 30s
  - match:
    - uri:
        prefix: /task-dependency-management/
    route:
    - destination:
        host: task-dependency-management-service
        port:
          number: 3013
    timeout: 30s
  - match:
    - uri:
        prefix: /benchmarking/
    route:
    - destination:
        host: benchmarking-service
        port:
          number: 3014
    timeout: 30s
  - match:
    - uri:
        prefix: /forecasting/
    route:
    - destination:
        host: forecasting-service
        port:
          number: 3016
    timeout: 30s
  - match:
    - uri:
        prefix: /interactive-dashboards/
    route:
    - destination:
        host: interactive-dashboards-service
        port:
          number: 3017
    timeout: 30s
  - match:
    - uri:
        prefix: /data-export/
    route:
    - destination:
        host: data-export-service
        port:
          number: 3018
    timeout: 30s
